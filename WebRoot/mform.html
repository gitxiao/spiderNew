<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>永兴印刷订单生产管理系统-首页</title>
	<link rel="stylesheet" type="text/css" href="css/easyui/easyui.css" />
	<link rel="stylesheet" type="text/css" href="css/easyui/icon.css"/>
	<link rel="stylesheet" type="text/css" href="css/easyui/demo.css"/>
	<link rel="stylesheet" type="text/css" href="css/cf/table.css"/>
	<script type="text/javascript" src="js/easyui/jquery.min.js"></script>
	<script type="text/javascript" src="js/easyui/jquery.easyui.min.js"></script>
	<script type="text/javascript" src="js/easyui/easyui-lang-zh_CN.js"></script>
	<script type="text/javascript" src="js/json2.js"></script>
	
	<script type="text/javascript" src="js/myConstants.js"></script>
	<script type="text/javascript" src="js/myUtils.js"></script>
	<script type="text/javascript" src="js/myNames.js"></script>
	
	<script>
	
		var priceToolbar = [{text:'报价',
				iconCls:'icon-setprice',
				handler:function(){scanNoPriceForm();}
				}];
		var getToolbar = [{
				text:'查看详情',
				iconCls:'icon-search',
				handler:function(){scanNoGetForm();}
				},{text:'收款',
				iconCls:'icon-settle',
				handler:function(){getFormMoney();}
				}];
		var giveToolbar = [{
				text:'查看详情',
				iconCls:'icon-search',
				handler:function(){scanNoGiveForm();}
				},{text:'付款',
				iconCls:'icon-outsettle',
				handler:function(){giveFormMoney();}
				}];
		$(function(){
			loadNoPriceForm();
			loadNoGetForm();
			loadNoGiveForm();
			loadPartner();
			$("#makeType").combobox("setValue","1");
			$("#makeType2").combobox("setValue","1");
			
			setGcFormCode(getUserId());
			loadGcCustomerDate();
			loadGcPaperType();
			loadGcPartner();
		});
		
		function loadPartner(){
			$.post(opertionUrl+"partner/findPaperType",loadPatnerSuccess,"json");
		}
		function loadPatnerSuccess(data){
			$("#partnerComb").combobox('loadData', data);
			$("#partnerComb2").combobox('loadData', data);
			$("#partnerComb3").combobox('loadData', data);
		}
		
		//加载未报价的订单
		function loadNoPriceForm(){
			$.post(opertionUrl+"orderform/loadNoPriceForm",loadNoPriceFormSuccess,"json");
		}
		
		function loadNoPriceFormSuccess(data){
			$("#nopricedg").datagrid({loadFilter:pagerFilter,loadMsg:'数据正在加载,请耐心的等待...',striped:true}).datagrid('loadData', data)
		}
		function selectMakeType(){
			var val = $("#maketype").combobox('getValue');
			if(val=="2"){
				$("#printout").css("display","");
				$("#printself").css("display","none");
			}else{
				$("#printout").css("display","none");
				$("#printself").css("display","");
			}
		}
		function selectMakeType2(){
			var val = $("#maketype2").combobox('getValue');
			if(val=="2"){
				$("#printoutpt").css("display","");
				$("#printoutpr").css("display","");
				$("#printself2").css("display","none");
			}else{
				$("#printoutpt").css("display","none");
				$("#printoutpr").css("display","none");
				$("#printself2").css("display","");
			}
		}
		function scanNoPriceForm(){
			var rowval = $("#nopricedg").datagrid("getSelected");
			$("#formCode").prepend(rowval.formCode);
			$("#formDate").prepend(rowval.formDate);
			$("#cusName").prepend(rowval.cusName);
			$("#cusPhone").prepend(rowval.cusPhone);
			$("#productName").prepend(rowval.productName);
			$("#paperDetail").prepend(rowval.paperDetail);
			$("#productSize").prepend(rowval.productSize);
			$("#pagination").prepend(rowval.pagination);
			$("#printTypeName").prepend(rowval.printTypeName);
			$("#bindTypeName").prepend(rowval.bindTypeName);
			$("#productCount").prepend(rowval.productCount);
			$("#expectDate").prepend(rowval.expectDate);
			$("#designer").prepend(rowval.designer);
			$("#printFrom").prepend(rowval.printFrom);
			$("#bakCode").prepend(rowval.bakCode);
			$("#demoCode").prepend(rowval.demoCode);
			$("#formPrice").prepend(rowval.formPrice);
			$('#nopricedlg').dialog('open');
		}
		function setFormPrice(){
			var rowval = $("#nopricedg").datagrid("getSelected");
			$("#formCode1").prepend(rowval.formCode);
			$('#nopricedlg1').dialog('open');
		}
		function clearContent(){
			$("#formCode").html("");
			$("#formDate").html("");
			$("#cusName").html("");
			$("#cusPhone").html("");
			$("#productName").html("");
			$("#paperDetail").html("g/张");
			$("#productSize").html("K");
			$("#pagination").html("页");
			$("#printTypeName").html("");
			$("#bindTypeName").html("");
			$("#productCount").html("");
			$("#expectDate").html("");
			$("#designer").html("");
			$("#printFrom").html("");
			$("#bakCode").html("");
			$("#demoCode").html("");
			$("#formPrice").html("");
			$("#formCode1").html("");
			return true;
		}
		function submitPrice(){
			var val = $("#maketype").combobox('getValue');
			var rowval = $("#nopricedg").datagrid("getSelected");
			rowval.isGivePrice = 1;
			if(val=="2"){
				rowval.isPart = 2;
				rowval.makeType = 2;
				rowval.partnerId = $("#partnerComb").combobox("getValue"); 
				rowval.printPrice = $("#printPrice2").textbox("getValue");
			}else{
				rowval.isPart = 0;
				rowval.makeType = 1;
				rowval.printPrice = $("#printPrice1").textbox("getValue");
			}
			rowval.priceRemark = $("#priceRemark").textbox("getValue");
			alert('submitPrice rowval.priceRemark = ' + rowval.priceRemark);
			$.post(opertionUrl+"orderform/saveForm",{para:JSON.stringify(rowval)},submmitPriceSuccuss,"text");
		}
		
		function submmitPriceSuccuss(data){
			if(!data){
				$.messager.alert("操作提示","报价失败,请检查数据");
			}else if(data=="-2"){
				$.messager.alert("操作提示","报价失败,请检查数据");
			}else{
				$.messager.alert("操作提示","报价成功");
				$('#nopricedlg').dialog('close');
				loadNoPriceForm();
				loadNoGetForm();
				loadNoGiveForm();
			}
		}
		
		/*function submitPrice2(){
			var val = $("#maketype2").combobox('getValue');
			var rowval = $("#nopricedg").datagrid("getSelected");
			rowval.isGivePrice = 1;
			if(val=="2"){
				rowval.isPart = 2;
				rowval.makeType = 2;
				rowval.partnerId = $("#partnerComb2").combobox("getValue"); 
				rowval.printPrice = $("#printPrice4").textbox("getValue");
			}else{
				rowval.isPart = 0;
				rowval.makeType = 1;
				rowval.printPrice = $("#printPrice3").textbox("getValue");
			}
			rowval.priceRemark = $("#priceRemark1").textbox("getValue");
			alert('submitPrice2 rowval.priceRemark = ' + rowval.priceRemark);
			$.post(opertionUrl+"orderform/saveForm",{para:JSON.stringify(rowval)},submmitPrice2Succuss,"text");
		}*/
		function submmitPrice2Succuss(data){
			if(!data){
				$.messager.alert("操作提示","报价失败,请检查数据");
			}else if(data=="-2"){
				$.messager.alert("操作提示","报价失败,请检查数据");
			}else{
				$.messager.alert("操作提示","报价成功");
				$('#nopricedlg1').dialog('close');
				loadNoPriceForm();
				loadNoGetForm();
				loadNoGiveForm();
			}
		}
		
		function loadNoGetForm(){
			$.post(opertionUrl+"orderform/loadNoGetForm",loadNoGetFormSuccess,"json");
		}
		
		function loadNoGetFormSuccess(data){
			$("#nogetdg").datagrid({loadFilter:pagerFilter,loadMsg:'数据正在加载,请耐心的等待...',striped:true}).datagrid('loadData', data)
		}
		function scanNoGetForm(){
			var rowval = $("#nogetdg").datagrid("getSelected");
			$("#formCode2").prepend(rowval.formCode);
			$("#formDate1").prepend(rowval.formDate);
			$("#cusName1").prepend(rowval.cusName);
			$("#cusPhone1").prepend(rowval.cusPhone);
			$("#productName1").prepend(rowval.productName);
			$("#paperDetail1").prepend(rowval.paperDetail);
			$("#productSize1").prepend(rowval.productSize);
			$("#pagination1").prepend(rowval.pagination);
			$("#printTypeName1").prepend(rowval.printTypeName);
			$("#bindTypeName1").prepend(rowval.bindTypeName);
			$("#productCount1").prepend(rowval.productCount);
			$("#expectDate1").prepend(rowval.expectDate);
			$("#designer1").prepend(rowval.designer);
			$("#printFrom1").prepend(rowval.printFrom);
			$("#bakCode1").prepend(rowval.bakCode);
			$("#demoCode1").prepend(rowval.demoCode);
			$("#formPrice1").prepend(rowval.formPrice);
			$("#moneyValue").prepend(rowval.printPrice);
			$("#templateNum1").prepend(rowval.templateNum);
			$("#templatePrice1").prepend(rowval.templatePrice);
			$('#nogetdlg').dialog('open');
		}
		function clearContent2(){
			$("#formCode2").html("");
			$("#formDate1").html("");
			$("#cusName1").html("");
			$("#cusPhone1").html("");
			$("#productName1").html("");
			$("#paperDetail1").html("g/张");
			$("#productSize1").html("K");
			$("#pagination1").html("页");
			$("#printTypeName1").html("");
			$("#bindTypeName1").html("");
			$("#productCount1").html("");
			$("#expectDate1").html("");
			$("#designer1").html("");
			$("#printFrom1").html("");
			$("#bakCode1").html("");
			$("#demoCode1").html("");
			$("#formPrice1").html("");
			$("#moneyValue").html("");
			return true;
		}
		
		function getFormMoney(){
			$.messager.confirm("操作提示", "您确定已经收到该订单的款项了吗？", function (data) {if (data) {submitGetMoney();}else {return;}});
		}
		function submitGetMoney(){
			var rowval = $("#nogetdg").datagrid("getSelected");
			rowval.isGetMoney = 1;
			rowval.getMoneyDate = 1;
			$.post(opertionUrl+"orderform/saveForm",{para:JSON.stringify(rowval)},submmitGetMoneySuccuss,"text");
		}
		
		function submmitGetMoneySuccuss(data){
			if(!data){
				$.messager.alert("操作提示","操作失败,请重试");
			}else if(data=="-2"){
				$.messager.alert("操作提示","操作失败,请重试");
			}else{
				$.messager.alert("操作提示","操作成功");
				$('#nogetdlg').dialog('close');
				loadNoGetForm();
				loadNoPriceForm();
				loadNoGiveForm();
			}
		}
		
		
		
		
		function loadNoGiveForm(){
			$.post(opertionUrl+"orderform/loadNoGiveForm",loadNoGiveFormSuccess,"json");
		}
		
		function loadNoGiveFormSuccess(data){
			$("#nogivedg").datagrid({loadFilter:pagerFilter,loadMsg:'数据正在加载,请耐心的等待...',striped:true}).datagrid('loadData', data)
		}
		
		function scanNoGiveForm(){
			var rowval = $("#nogivedg").datagrid("getSelected");
			$("#formCode3").prepend(rowval.formCode);
			$("#formDate3").prepend(rowval.formDate);
			$("#cusName3").prepend(rowval.cusName);
			$("#cusPhone3").prepend(rowval.cusPhone);
			$("#productName3").prepend(rowval.productName);
			$("#paperDetail3").prepend(rowval.paperDetail);
			$("#productSize3").prepend(rowval.productSize);
			$("#pagination3").prepend(rowval.pagination);
			$("#printTypeName3").prepend(rowval.printTypeName);
			$("#bindTypeName3").prepend(rowval.bindTypeName);
			$("#productCount3").prepend(rowval.productCount);
			$("#expectDate3").prepend(rowval.expectDate);
			$("#designer3").prepend(rowval.designer);
			$("#printFrom3").prepend(rowval.printFrom);
			$("#bakCode3").prepend(rowval.bakCode);
			$("#demoCode3").prepend(rowval.demoCode);
			$("#formPrice3").prepend(rowval.formPrice);
			$("#moneyValue3").prepend(rowval.printPrice);
			$("#templateNum3").prepend(rowval.templateNum);
			$("#templatePrice3").prepend(rowval.templatePrice);
			$('#nogivedlg').dialog('open');
		}
		
		function clearContent3(){
			$("#formCode3").html("");
			$("#formDate3").html("");
			$("#cusName3").html("");
			$("#cusPhone3").html("");
			$("#productName3").html("");
			$("#paperDetail3").html("g/张");
			$("#productSize3").html("K");
			$("#pagination3").html("页");
			$("#printTypeName3").html("");
			$("#bindTypeName3").html("");
			$("#productCount3").html("");
			$("#expectDate3").html("");
			$("#designer3").html("");
			$("#printFrom3").html("");
			$("#bakCode3").html("");
			$("#demoCode3").html("");
			$("#formPrice3").html("");
			$("#moneyValue3").html("");
			return true;
		}
		function giveFormMoney(){
			$.messager.confirm("操作提示", "您确定已经支付该订单的款项了吗？", function (data) {if (data) {submitGiveMoney();}else {return;}});
		}
		function submitGiveMoney(){
			var rowval = $("#nogivedg").datagrid("getSelected");
			rowval.isGiveMoney = 1;
			rowval.giveMoneyDate = 1;
			$.post(opertionUrl+"orderform/saveForm",{para:JSON.stringify(rowval)},submmitGiveMoneySuccuss,"text");
		}
		
		function submmitGiveMoneySuccuss(data){
			if(!data){
				$.messager.alert("操作提示","操作失败,请重试");
			}else if(data=="-2"){
				$.messager.alert("操作提示","操作失败,请重试");
			}else{
				$.messager.alert("操作提示","操作成功");
				$('#nogivedlg').dialog('close');
				loadNoGiveForm();
				loadNoGetForm();
				loadNoPriceForm();
				
			}
		}
		
		function getUserId(){
	
			var nurl = window.document.location.href;
			var codeIndex = nurl.indexOf("userid");
			if(codeIndex==-1) return "false";
			var keyValue = nurl.substring(codeIndex,nurl.length);
			if(keyValue.indexOf("=")==-1) return false;
			var values = keyValue.split("=");
			if(values!=null&&values.length!=0){
				return values[1];
			}else{
				return "false";
			}
		}
		
		function setGcFormCode(userid){
			$.post(opertionUrl+"orderform/findNextFormCode",{userId:userid},loadGcNextCodeSuccess,"text");
		}
		function loadGcNextCodeSuccess(data){
			$("#gcformNum").textbox('setValue',data);
		}
		
		function loadGcCustomerDate(){
			$.post(opertionUrl+"customer/findAll",loadGcDataSuccess,"json");
		}
		function loadGcDataSuccess(data){
			$("#gccustomer").combobox('loadData', data);
		}
		function loadGcPaperType(){
			$.post(opertionUrl+"material/findPaperType",loadGcPaperTypeSuccess,"json");
		}
		function loadGcPaperTypeSuccess(data){
			$("#gcpaperType").combobox('loadData', data);
		}
		function loadGcPartner(){
			$.post(opertionUrl+"partner/findPaperType",loadGcPatnerSuccess,"json");
		}
		function loadGcPatnerSuccess(data){
			$("#gcpartnerComb").combobox('loadData', data);
		}
		function loadGcPaperSize(){
			var dtype = $("#gcpaperType").combobox('getValue');
			$.post(opertionUrl+"material/findPaperSize",{dtype:dtype},loadGcPaperSizeSuccess,"json");
		}
		function loadGcPaperSizeSuccess(data){
			$("#gcpaperSize").combobox('loadData', data);
			$("#gcpaperSize").combobox('setValue', $("#gcpaperSize").combobox("getValue"));
		}
		function selectGcPtype(){
			var val = $("#gcmaketype").combobox('getValue');
			if(val=="2"){
				$("#gcouthelp").css("display","");
			}else{
				$("#gcouthelp").css("display","none");
			}
		}
		
		function submitGcForm(){
			var obj = new Object();
			obj.formCode=$("#gcformNum").textbox('getValue');
			obj.customerId =$("#gccustomer").combobox('getValue');
			obj.cusPhone = $("#gcphoneNum").textbox('getValue');
			obj.productName = $("#gcproductName").textbox('getValue');
			obj.paperId =$("#gcpaperSize").combobox('getValue');
			obj.productSize = $("#gcproductSize").textbox('getValue');
			obj.pagination = $("#gcpagination").textbox('getValue');
			obj.printType = $("#gcprintType").combobox('getValue');
			obj.bindtype = $("#gcbindtype").combobox('getValue');
			obj.printFrom=$("#gcprintFrom").textbox('getValue');
			obj.bakCode = $("#gcbakCode").textbox("getValue");
			obj.demoCode = $("#gcdemoCode").textbox("getValue");
			obj.formPrice = $("#gcformPrice").textbox("getValue");
			obj.makeType = $("#gcmaketype").combobox('getValue');
			obj.partnerId = $("#gcpartnerComb").combobox('getValue')? $("#gcpartnerComb").combobox('getValue'):0;
			obj.remark = $("#gcremark").textbox("getValue");
			obj.productCount = $("#gcproductCount").textbox("getValue");
			obj.designer = $("#gcdesigner").textbox("getValue");			
			obj.expectDate = $("#gcendDate").datebox("getValue");
			obj.templatePrice = $("#templatePrice").textbox("getValue");
			obj.templateNum = $("#templateNum").textbox("getValue");
			obj.isGivePrice = 1;
			if(obj.makeType==2){
				obj.isPart = 2;
				obj.printPrice = $("#gcprintPrice").textbox("getValue")? $("#gcprintPrice").textbox("getValue"):0;
			}else {
				obj.isPart = 0;
				obj.printPrice = obj.formPrice;
			}
			obj.userId =  getUserId();
			obj.isFinish = 1;
			obj.state = 2;
			obj.isGiveMoney = 0;
			obj.isGetMoney = 0;
			$.post(opertionUrl+"orderform/saveForm",{para:JSON.stringify(obj)},addGcFormSuccuss,"text");
		}
		function addGcFormSuccuss(data){
			if(!data){
				$.messager.alert("操作提示","保存订单失败,请检查数据");
			}else if(data=="-2"){
				$.messager.alert("操作提示","保存订单失败,请检查数据");
			}else{
				$.messager.alert("操作提示","保存订单成功");
				$('#ff').form('clear');
				setGcFormCode(getUserId());
				loadNoGetForm();
				loadNoGiveForm();
			}
		}
		
		
	</script>
</head>
<body>
	<div class="easyui-tabs" style="width:auto;height:auto;">
		<div title="订单报价" style="padding:10px;">
			<table id="nopricedg" style="width:840px;height:350px" data-options="
						rownumbers:true,
						singleSelect:true,
						autoRowHeight:false,
						pagination:true,
						pageSize:10,
						toolbar:priceToolbar">
				<thead>
					<tr>
						<th field="formCode" width="120">订单编号</th>
						<th field="cusName" width="150">客户名称</th>
						<th field="cusPhone" width="100">联系电话</th>
						<th field="expectDate" width="80" align="right">交货日期</th>
						<th field="printTypeName" width="40" align="right">工艺</th>
						<th field="pagination" width="60" align="right">成品页数</th>
						<th field="productCount" width="60">成品数量</th>
					</tr>
				</thead>
			</table>
			<!-- <div id="nopricedlg1" class="easyui-dialog" title="订单报价" data-options="iconCls:'icon-save',closed:true,onBeforeClose:function(){return clearContent();}" style="width:300px;height:280px;padding:10px">
				<form id="ff3" method="post">
					<table cellpadding="5">
						<tr>
							<td>订单编号:</td>
							<td id="formCode1"></td>
						</tr>
						<tr>
							<td>加工类型</td>
							<td>
								<select id="maketype2" class="easyui-combobox" name="加工类型" data-options="onSelect:selectMakeType2" style="width:140px;">
									<option value="1">自印</option>
									<option value="2">外协</option>
								</select>
							</td>
						</tr>
						<tr id="printself2">
							<td>印刷价格:</td>
							<td><input id="printPrice3" class="easyui-numberbox" data-options="required:true" name="name" ></input></td>
						</tr>
						<tr id="printoutpt" style="display: none">
							<td>外协单位:</td>
							<td><input id="partnerComb2" style="width: 140px" class="easyui-combobox" data-options="valueField:'id',textField:'partnerName'" /></td>
						</tr>
						<tr id="printoutpr" style="display: none">
							<td>外协价格:</td>
							<td><input id="printPrice4" style="width: 140px" class="easyui-numberbox" data-options="required:true" name="name" ></input></td>
						</tr>
						<tr>
							<td>备注</td>
							<td> <input id="priceRemark1" style="width:140px;height: 100px;" class="easyui-textbox" type="text" name="remark" /> </td>
						</tr>
					</table>
				</form>
				<div style="text-align:center;padding:5px">
					<a href="javascript:void(0)" class="easyui-linkbutton" onclick="submitPrice2()">报价</a>
				</div>
			</div>
			 -->
			<div id="nopricedlg" class="easyui-dialog" title="订单报价" data-options="iconCls:'icon-save',closed:true,onBeforeClose:function(){return clearContent();}" style="width:730px;height:430px;padding:10px">
				<form id="ff2" method="post">
					<table class="tablecss" >
						<tr>
							<th colspan="6" align="center">永兴印刷订单详情</th>
						</tr>
						<tr>
							<td>订单编号:</td>
							<td id="formCode"></td>
							<td>订单时间:</td>
							<td id="formDate"></td>
							<td>客户名称:</td>
							<td id="cusName"></td>
						</tr>
						<tr>
							<td>联系电话:</td>
							<td id="cusPhone"></td>
							<td>印刷品名称:</td>
							<td id="productName"></td>
							<td>纸张:</td>
							<td id="paperDetail">g/张</td>
						</tr>
						<tr>
							<td>成品尺寸:</td>
							<td id="productSize">K</td>
							<td>页码数量:</td>
							<td id="pagination">页</td>
							<td>印刷工艺:</td>
							<td id="printTypeName"></td>
						</tr>
						<tr>
							<td>装订方式:</td>
							<td id="bindTypeName"></td>
							<td>成品数量:</td>
							<td id="productCount"></td>
							<td>交货时间:</td>
							<td id="expectDate"></td>
						</tr>
						<tr>
							<td>设计师:</td>
							<td id="designer"></td>
							<td>出版地:</td>
							<td id="printFrom"></td>
							<td>内资备案号:</td>
							<td id="bakCode"></td>
						</tr>

						<tr>
							<td>小样备案号:</td>
							<td id="demoCode"></td>
							<td>订单价格：</td>
							<td id="formPrice"></td>
							<td>加工类型:</td>
							<td>
								<select id="maketype" class="easyui-combobox" name="加工类型" data-options="onSelect:selectMakeType" style="width:140px;">
									<option value="1">自印</option>
									<option value="2">外协</option>
								</select>
							</td>
						</tr>
						<tr id="printself">
							<td>印刷价格:</td>
							<td colspan="5"><input id="printPrice1" class="easyui-numberbox" data-options="required:true" name="name" ></input></td>
						</tr>
						<tr id="printout" style="display:none">
							<td>外协单位:</td>
							<td colspan="2"><input id="partnerComb" style="width: 140px" class="easyui-combobox" data-options="valueField:'id',textField:'partnerName'"></input></td>
							
							<td>外协价格:</td>
							<td colspan="2"><input id="printPrice2" style="width: 140px" class="easyui-numberbox" data-options="required:true" name="name" ></input></td>
						</tr>
						<tr>
							<td>备注</td>
							<td> <input id="priceRemark" style="width:140px" class="easyui-textbox" type="text" name="remark" /> </td>
						</tr>
					</table>
				</form>
				<div style="text-align:center;padding:5px">
					<a href="javascript:void(0)" class="easyui-linkbutton" onclick="submitPrice()">提交</a>
				</div>
			</div>
		</div>
		<!-- ------------------------------------------------订单报价功能结束--------------------------------------------------------------------------------------- -->
		<div title="订单收款" style="padding:10px;">
			<table id="nogetdg" style="width:840px;height:400px" data-options="
						rownumbers:true,
						singleSelect:true,
						autoRowHeight:false,
						pagination:true,
						pageSize:10,
						toolbar:getToolbar">
				<thead>
					<tr>
						<th field="formCode" width="120">订单编号</th>
						<th field="cusName" width="150">客户名称</th>
						<th field="cusPhone" width="100">联系电话</th>
						<th field="expectDate" width="80" align="right">交货日期</th>
						<th field="printTypeName" width="40" align="right">工艺</th>
						<th field="pagination" width="60" align="right">成品页数</th>
						<th field="productCount" width="60">成品数量</th>
						<th field="printPrice" width="60">应收金额</th>
					</tr>
				</thead>
			</table>
			
			<div id="nogetdlg" class="easyui-dialog" title="订单详情" data-options="iconCls:'icon-save',closed:true,onBeforeClose:function(){return clearContent2();}" style="width:730px;height:400px;padding:10px">
				<form id="ff2" method="post">
					<table class="tablecss" >
						<tr>
							<th colspan="6" align="center">永兴印刷订单详情</th>
						</tr>
						<tr>
							<td>订单编号:</td>
							<td id="formCode2"></td>
							<td>订单时间:</td>
							<td id="formDate1"></td>
							<td>客户名称:</td>
							<td id="cusName1"></td>
						</tr>
						<tr>
							<td>联系电话:</td>
							<td id="cusPhone1"></td>
							<td>印刷品名称:</td>
							<td id="productName1"></td>
							<td>纸张:</td>
							<td id="paperDetail1">g/张</td>
						</tr>
						<tr>
							<td>成品尺寸:</td>
							<td id="productSize1">K</td>
							<td>页码数量:</td>
							<td id="pagination1">页</td>
							<td>印刷工艺:</td>
							<td id="printTypeName1"></td>
						</tr>
						<tr>
							<td>装订方式:</td>
							<td id="bindTypeName1"></td>
							<td>成品数量:</td>
							<td id="productCount1"></td>
							<td>交货时间:</td>
							<td id="expectDate1"></td>
						</tr>
						<tr>
							<td>设计师:</td>
							<td id="designer1"></td>
							<td>出版地:</td>
							<td id="printFrom1"></td>
							<td>内资备案号:</td>
							<td id="bakCode1"></td>
						</tr>
						<tr>
							<td>版数:</td>
							<td id="templateNum1" name="ddxq"></td>
							<td>版单价:</td>
							<td id="templatePrice1" name="ddxq"></td>
							<td>报价备注:</td>
							<td id="ddxqpriceRemark1" name="ddxq"></td>
						</tr>
						
						<tr>
							<td>小样备案号:</td>
							<td id="demoCode1"></td>
							<td>订单价格：</td>
							<td id="formPrice1"></td>
							<td>应收金额:</td>
							<td id="moneyValue"></td>
						</tr>						
					</table>
				</form>
				<div style="text-align:center;padding:5px">
					<a href="javascript:void(0)" class="easyui-linkbutton" onclick="getFormMoney()">收款</a>
				</div>
			</div>
		</div>	
			
		<!-- ----------------------------------------------订单收款功能结束---------------------------------------------------------------------------------------------- -->
		<div title="订单付款" style="padding:10px;">
			<table id="nogivedg" style="width:840px;height:350px" data-options="
						rownumbers:true,
						singleSelect:true,
						autoRowHeight:false,
						pagination:true,
						pageSize:10,
						toolbar:giveToolbar">
				<thead>
					<tr>
						<th field="formCode" width="120">订单编号</th>
						<th field="cusName" width="150">客户名称</th>
						<th field="cusPhone" width="100">联系电话</th>
						<th field="expectDate" width="80" align="right">交货日期</th>
						<th field="printTypeName" width="40" align="right">工艺</th>
						<th field="pagination" width="60" align="right">成品页数</th>
						<th field="productCount" width="60">成品数量</th>
						<th field="printPrice" width="60">应付金额</th>
					</tr>
				</thead>
			</table>
			<div id="nogivedlg" class="easyui-dialog" title="订单详情" data-options="iconCls:'icon-save',closed:true,onBeforeClose:function(){return clearContent3();}" style="width:730px;height:400px;padding:10px">
				<form id="ff2" method="post">
					<table class="tablecss" >
						<tr>
							<th colspan="6" align="center">永兴印刷订单详情</th>
						</tr>
						<tr>
							<td>订单编号:</td>
							<td id="formCode3"></td>
							<td>订单时间:</td>
							<td id="formDate3"></td>
							<td>客户名称:</td>
							<td id="cusName3"></td>
						</tr>
						<tr>
							<td>联系电话:</td>
							<td id="cusPhone3"></td>
							<td>印刷品名称:</td>
							<td id="productName3"></td>
							<td>纸张:</td>
							<td id="paperDetail3">g/张</td>
						</tr>
						<tr>
							<td>成品尺寸:</td>
							<td id="productSize3">K</td>
							<td>页码数量:</td>
							<td id="pagination3">页</td>
							<td>印刷工艺:</td>
							<td id="printTypeName3"></td>
						</tr>
						<tr>
							<td>装订方式:</td>
							<td id="bindTypeName3"></td>
							<td>成品数量:</td>
							<td id="productCount3"></td>
							<td>交货时间:</td>
							<td id="expectDate3"></td>
						</tr>
						<tr>
							<td>设计师:</td>
							<td id="designer3"></td>
							<td>出版地:</td>
							<td id="printFrom3"></td>
							<td>内资备案号:</td>
							<td id="bakCode3"></td>
						</tr>

						<tr>
							<td>版数:</td>
							<td id="templateNum3" name="ddxq"></td>
							<td>版单价:</td>
							<td id="templatePrice3" name="ddxq"></td>
							<td>报价备注:</td>
							<td id="ddxqpriceRemark3" name="ddxq"></td>
						</tr>
						
						<tr>
							<td>小样备案号:</td>
							<td id="demoCode3"></td>
							<td>订单价格：</td>
							<td id="formPrice3"></td>
							<td>应付金额:</td>
							<td id="moneyValue3"></td>
						</tr>						
					</table>
				</form>
				<div style="text-align:center;padding:5px">
					<a href="javascript:void(0)" class="easyui-linkbutton" onclick="giveFormMoney()">付款</a>
				</div>
			</div>
		</div>
		
		
		
		<!-- ----------------------------------------------订单付款功能结束---------------------------------------------------------------------------------------------- -->
		
		
		<div title="在线下订单" style="padding:10px">
			<div style="padding:10px 60px 20px 60px">
				<form id="ff" method="post">
					<table cellpadding="5">
						<tr>
							<td>订单编号:</td>
							<td><input id="gcformNum" class="easyui-textbox" data-options="required:true" readonly="readonly" type="text" ></input></td>
							<td>客户名称:</td>
							<td><input id="gccustomer" class="easyui-combobox" data-options="valueField:'id',textField:'cusName'"></input></td>
							<td>联系电话:</td>
							<td><input id="gcphoneNum" missingMessage="请输入电话号码(格式:0318861000/13900006666)" class="easyui-numberbox" data-options="required:true" type="text" ></input></td>
						</tr>
						<tr>
							<td>印刷品名称:</td>
							<td><input id="gcproductName" missingMessage="印刷品名称为必输项" class="easyui-textbox" data-options="required:true" type="text"  ></input></td>
							<td>纸张类型:</td>
							<td>
								<input id="gcpaperType" class="easyui-combobox" data-options="valueField:'dtype',textField:'mname',onSelect:loadGcPaperSize "></input>
							</td>
							<td>纸张规格:</td>
							<td>
								<input id="gcpaperSize" class="easyui-combobox" data-options="valueField:'id',textField:'msize' "></input>
							</td>
						</tr>
						<tr>
							<td>成品尺寸:</td>
							<td>
								<input id="gcproductSize" missingMessage="成品尺寸为数字必输项" class="easyui-numberbox" style="width:100px" data-options="required:true" type="text"  /> &nbsp;&nbsp;K
							</td>
							<td>页码数量:</td>
							<td><input id="gcpagination"  missingMessage="数字必输项,单面印刷时页码数X2" class="easyui-numberbox" data-options="required:true"  ></input></td>
							<td>印刷工艺:</td>
							<td>
								<select id="gcprintType" class="easyui-combobox" name="印刷工艺" style="width:140px;">
									<option value="1">覆膜</option>
									<option value="2">UV</option>
									<option value="3">压纹</option>
									<option value="4">起鼓</option>
									<option value="5">烫金</option>
									<option value="6">烫银</option>
									<option value="7">花线</option>
									<option value="8">磨切</option>
									<option value="9">压痕</option>
								</select>
							</td>
						</tr>
						<tr>
							<td>装订方式:</td>
							<td>
								<select id="gcbindtype" class="easyui-combobox" name="装订方式" style="width:140px;">
									<option value="1">线订</option>
									<option value="2">胶订</option>
									<option value="3">骑马订</option>
									<option value="4">无缝装</option>
								</select>
							</td>
							<td>成品数量:</td>
							<td><input id="gcproductCount" missingMessage="成品数量为数字必输项" class="easyui-numberbox" data-options="required:true"  ></input></td>
							<td>交货时间:</td>
							<td><input id="gcendDate" class="easyui-datebox" ></input></td>
						</tr>
						<tr>
							<td>设计师:</td>
							<td>
								<input id="gcdesigner" class="easyui-textbox" data-options="required:true" type="text" />
							</td>
							<td>出版地:</td>
							<td>
								<select id="gcprintFrom" class="easyui-combobox" name="出版地" style="width:140px;">
									<option value="1">印刷学校</option>
									<option value="2">飞腾</option>
									<option value="3">衡武</option>
								</select>
							</td>
							<td>内资备案号:</td>
							<td>
								<input id="gcbakCode" class="easyui-textbox" data-options="required:true" type="text" />
							</td>
						</tr>

						<tr>
							<td >版数:</td>
							<td ><input id="templateNum" class="easyui-numberbox" missingMessage="版数为数字必输项" data-options="required:true" style="width:140px;"></input></td>
							<td >版单价:</td>
							<td ><input id="templatePrice" class="easyui-numberbox" missingMessage="版单价为数字必输项" data-options="required:true" style="width:140px;"></input></td>
							<td>订单价格：</td>
							<td><input id="gcformPrice" class="easyui-numberbox"  missingMessage="订单价格为数字必输项"  data-options="required:true" name="formPrice" ></input></td>
						</tr>
						<tr>
							<td>小样备案号:</td>
							<td>
								<input id="gcdemoCode" class="easyui-textbox" data-options="required:true" type="text" name="demoCode" />
							</td>
							<td>加工类型:</td>
							<td>
								<select id=gcmaketype class="easyui-combobox" name="加工类型" data-options="onSelect:selectGcPtype ,editable:false" style="width:140px;">
									<option value="1">自印</option>
									<option value="2">外协</option>
								</select>
							</td>
						</tr>
						
						<tr id="gcouthelp" style="display:none">
							<td>外协单位:</td>
							<td colspan="2"><input id="partnerComb3" style="width: 140px" class="easyui-combobox" data-options="valueField:'id',textField:'partnerName'"></input></td>
							<td></td>
							<td>外协价格：</td>
							<td ><input id="gcprintPrice" class="easyui-numberbox" missingMessage="外协价格为数字必输项" data-options="required:true" style="width:140px;"></input></td>
						</tr>
						<tr>
							<td>备注</td>
							<td colspan="5"> <input id="gcremark" style="width:600px;height: 100px;" class="easyui-textbox" type="text"  /> </td>
						</tr>
					</table>
				</form>
				<div style="text-align:center;padding:5px">
					<a href="javascript:void(0)" class="easyui-linkbutton" onclick="submitGcForm()">提交</a>
				</div>
			</div>
		</div>
		
		<!-- -------------------------------------------------------在线下订单完成------------------------------------------------------------------------ -->
		
		<div title="订单查询" style="padding:10px;">
			<div class="easyui-panel" style="padding:5px;width:840px;">
				<a href="#" class="easyui-linkbutton" data-options="toggle:true,group:'g1',selected:true" style="margin:3px 5px 3px 0px;">全&nbsp&nbsp&nbsp&nbsp部</a>
				<span style="padding:3px 0px 3px 5px;">生产状态：</span>				
				<a href="#" class="easyui-linkbutton" data-options="toggle:true,group:'g1'" style="margin:3px 5px 3px 5px;">未报价</a>
				<a href="#" class="easyui-linkbutton" data-options="toggle:true,group:'g1'" style="margin:3px 5px 3px 5px;">加工中</a>
				<a href="#" class="easyui-linkbutton" data-options="toggle:true,group:'g1'" style="margin:3px 5px 3px 5px;">已完成</a>
				<span style="padding:3px 0px 3px 10px;">付款状态：</span>
				<a href="#" class="easyui-linkbutton" data-options="toggle:true,group:'g3'" style="margin:3px 5px 3px 5px;">未付款</a>
				<a href="#" class="easyui-linkbutton" data-options="toggle:true,group:'g3'" style="margin:3px 5px 3px 5px;">已付款</a>
				<span style="padding:3px 0px 3px 10px;">收款状态：</span>
				<a href="#" class="easyui-linkbutton" data-options="toggle:true,group:'g2'" style="margin:3px 5px 3px 5px;">未收款</a>
				<a href="#" class="easyui-linkbutton" data-options="toggle:true,group:'g2'" style="margin:3px 5px 3px 5px;">已收款</a>
			</div>
			
			<table id="dg" style="width:840px;height:350px" data-options="
						rownumbers:true,
						singleSelect:true,
						autoRowHeight:false,
						pagination:true,
						pageSize:10">
				<thead>
					<tr>
						<th field="formCode" width="120">订单编号</th>
						<th field="cusName" width="150">客户名称</th>
						<th field="cusPhone" width="100">联系电话</th>
						<th field="expectDate" width="80" align="right">交货日期</th>
						<th field="printTypeName" width="40" align="right">工艺</th>
						<th field="pagination" width="60" align="right">成品页数</th>
						<th field="productCount" width="60">成品数量</th>
						<th field="pstate" width="60">生产状态</th>
						<th field="dstate" width="60">收款状态</th>
						<th field="outstate" width="60">付款状态</th>
					</tr>
				</thead>
			</table>
			
			<script>
				function submitPrice1(){
					$.messager.confirm("操作提示", "请确定价格没有错误！", function (data) {  
						if (data) {  
							alert("确定");  
						}  
						else {  
							alert("取消");  
						}  
					});    
					//$('#ff2').form('submit');
				}
				
				/*
				function submitPrice1(){
					$.messager.alert("操作提示","报价完成");
					$('#spdlg2').dialog('close');
				}*/
				

				function selectPtype(){
					var val = $("#selectPTypeId").combobox('getValue');
					if(val=="bg"){
						$("#outhelp").css("display","");
					}else{
						$("#outhelp").css("display","none");
					}
					
				}

				function getAccount(){
					$.messager.confirm("操作提示", "您确定该订单已经收款了吗？", function (data) {  
						if (data) {  
							alert("确定");  
						}  
						else {  
							alert("取消");  
						}  
					});   
				}

				function setAccount(){
					$.messager.confirm("操作提示", "您确定该订单已经付款了吗？", function (data) {  
						if (data) {  
							alert("确定");  
						}  
						else {  
							alert("取消");  
						}  
					});   
				}

				function settleAccount(){
					$.messager.confirm("操作提示", "您确定该订单需要结算吗？", function (data) {  
						if (data) {  
							alert("确定");  
						}  
						else {  
							alert("取消");  
						}  
					});   
				}

				
				function fillDdData(data){
					$("#dg").datagrid({loadFilter:pagerFilter,loadMsg:'数据正在加载,请耐心的等待...',striped:true}).datagrid('loadData', data)
				}
				function getDdData(){
					$.post(opertionUrl+"orderform/getOrderFormByUserId",{userId:getUserId()},fillDdData,"json");
				}
				$(function(){
					getDdData();
				});
			</script>
		</div>
	</div>
</body>
</html>